import{a as O,b as V}from"./chunk-2EKU6FZ4.js";import{a as L,b as G}from"./chunk-LJNQN635.js";import"./chunk-XV66PAZG.js";import{a as I,b as q}from"./chunk-CCNTREEN.js";import{a as B}from"./chunk-B2CXB3HZ.js";import"./chunk-OL4HAED7.js";import"./chunk-EG54LRXD.js";import{Bb as m,Kc as b,La as a,Nd as g,Qb as r,Qe as k,Re as M,U as d,Xb as _,Ya as h,Zd as E,_d as u,ae as v,be as C,de as x,ee as S,fe as y,ge as D,ke as w,le as F,me as T,oe as A,pb as l,qb as e,rb as t,sb as p,te as P,ue as N}from"./chunk-ESYVRVYB.js";var H=class f{fb=d(T);settingsService=d(B);messageService=d(g);settingForm;cameras=[];isLoading=!1;resolutions=[{label:"\u{1F680} FWVGA (854 x 480) - Si\xEAu m\u01B0\u1EE3t [Khuy\xEAn d\xF9ng Pi 3]",value:"854x480"},{label:"HD (1280 x 720) - 16:9 [Ti\xEAu chu\u1EA9n]",value:"1280x720"},{label:"VGA (640 x 480) - 4:3 [Nh\u1EB9]",value:"640x480"},{label:"SVGA (800 x 600) - 4:3",value:"800x600"},{label:"Full HD (1920 x 1080) - [N\u1EB7ng]",value:"1920x1080"}];aiOptions=[{label:"Th\u1EA5p (0.3) - Nh\u1EA1y, d\u1EC5 b\u1EAFt nh\u1EA7m",value:.3},{label:"Trung b\xECnh (0.5) - Khuy\xEAn d\xF9ng",value:.5},{label:"Cao (0.7) - Ch\xEDnh x\xE1c",value:.7},{label:"R\u1EA5t cao (0.85) - R\u1EA5t ch\u1EB7t ch\u1EBD",value:.85}];timeoutOptions=[{label:"30 gi\xE2y (Nhanh)",value:30},{label:"1 ph\xFAt (Ti\xEAu chu\u1EA9n)",value:60},{label:"2 ph\xFAt",value:120},{label:"5 ph\xFAt",value:300},{label:"10 ph\xFAt",value:600}];fpsOptions=[{label:"10 FPS (T\u1ED1i \u01B0u l\u01B0u tr\u1EEF)",value:10},{label:"15 FPS (M\u01B0\u1EE3t m\xE0)",value:15},{label:"20 FPS (Ti\xEAu chu\u1EA9n)",value:20},{label:"25 FPS (Cao - T\u1ED1n dung l\u01B0\u1EE3ng)",value:25}];fpsViewOptions=[{label:"10 FPS (Ti\u1EBFt ki\u1EC7m CPU)",value:10},{label:"15 FPS (Khuy\xEAn d\xF9ng)",value:15},{label:"20 FPS (M\u01B0\u1EE3t)",value:20},{label:"25 FPS (R\u1EA5t m\u01B0\u1EE3t - T\u1ED1n CPU)",value:25}];constructor(){this.settingForm=this.fb.group({save_media:["app/media",u.required],resolution:["854x480",u.required],ai_confidence:[.5,u.required],timeout_no_human:[60,u.required],work_end_time:["18:30",u.required],read_end_order:[5,u.required],perf_record_fps:[10,u.required],perf_view_fps:[15,u.required],perf_ai_interval:[12,u.required]})}ngOnInit(){this.loadData()}loadData(){this.isLoading=!0,this.settingsService.getCameras().subscribe({next:n=>this.cameras=n,error:()=>console.warn("Kh\xF4ng t\u1EA3i \u0111\u01B0\u1EE3c danh s\xE1ch camera")}),this.settingsService.getSettings().subscribe({next:n=>{let s=n.camera_width||854,i=n.camera_height||480,o=`${s}x${i}`;this.resolutions.some(R=>R.value===o)||this.resolutions.push({label:`T\xF9y ch\u1EC9nh (${s} x ${i})`,value:o}),this.settingForm.patchValue({save_media:n.save_media||"app/media",resolution:o,ai_confidence:Number(n.ai_confidence)||.5,timeout_no_human:Number(n.timeout_no_human)||60,work_end_time:n.work_end_time||"18:30",read_end_order:Number(n.read_end_order)||5,perf_record_fps:Number(n.perf_record_fps)||10,perf_view_fps:Number(n.perf_view_fps)||15,perf_ai_interval:Number(n.perf_ai_interval)||12}),this.isLoading=!1},error:n=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:"Kh\xF4ng t\u1EA3i \u0111\u01B0\u1EE3c c\u1EA5u h\xECnh t\u1EEB Server"}),this.isLoading=!1}})}saveSettings(){if(this.settingForm.invalid){this.messageService.add({severity:"warn",summary:"C\u1EA3nh b\xE1o",detail:"Vui l\xF2ng \u0111i\u1EC1n \u0111\u1EA7y \u0111\u1EE7 th\xF4ng tin"});return}this.isLoading=!0;let n=this.settingForm.value,[s,i]=n.resolution.split("x"),o={save_media:n.save_media,camera_width:String(s),camera_height:String(i),ai_confidence:String(n.ai_confidence),timeout_no_human:String(n.timeout_no_human),work_end_time:String(n.work_end_time),read_end_order:String(n.read_end_order),perf_record_fps:String(n.perf_record_fps),perf_view_fps:String(n.perf_view_fps),perf_ai_interval:String(n.perf_ai_interval)};console.log("\u{1F680} Sending Payload:",o),this.settingsService.updateSettings(o).subscribe({next:c=>{this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"\u0110\xE3 l\u01B0u c\u1EA5u h\xECnh. H\xE3y kh\u1EDFi \u0111\u1ED9ng l\u1EA1i d\u1ECBch v\u1EE5 Camera \u0111\u1EC3 \xE1p d\u1EE5ng.",life:4e3}),this.isLoading=!1},error:c=>{console.error("\u274C Save Error:",c),this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:"Kh\xF4ng th\u1EC3 l\u01B0u c\u1EA5u h\xECnh xu\u1ED1ng Database"}),this.isLoading=!1}})}static \u0275fac=function(s){return new(s||f)};static \u0275cmp=h({type:f,selectors:[["app-settings"]],features:[_([g])],decls:75,vars:9,consts:[[1,"surface-section","p-4","md:p-6","lg:p-8"],[1,"grid","grid-cols-1","md:grid-cols-2","xl:grid-cols-3","gap-4","max-w-full","mx-auto","pb-8"],[1,"col-span-1"],["header","\u2699\uFE0F Camera & H\xECnh \u1EA3nh","styleClass","h-full shadow-md"],[1,"flex","flex-col","gap-5",3,"formGroup"],[1,"flex","flex-col","gap-2"],[1,"font-bold","text-gray-700"],["formControlName","resolution","optionLabel","label","optionValue","value","placeholder","Ch\u1ECDn \u0111\u1ED9 ph\xE2n gi\u1EA3i","styleClass","w-full",3,"onChange","options"],[1,"text-blue-500"],[1,"pi","pi-info-circle"],["pInputText","","formControlName","save_media","placeholder","app/media",1,"w-full",3,"blur"],[1,"text-gray-500"],["header","\u{1F916} V\u1EADn h\xE0nh & AI","styleClass","h-full shadow-md"],["formControlName","timeout_no_human","optionLabel","label","optionValue","value","placeholder","Ch\u1ECDn th\u1EDDi gian ch\u1EDD","styleClass","w-full",3,"onChange","options"],["formControlName","ai_confidence","optionLabel","label","optionValue","value","placeholder","Ch\u1ECDn \u0111\u1ED9 nh\u1EA1y","styleClass","w-full",3,"onChange","options"],[1,"flex","align-items-center","gap-2"],["pInputText","","type","number","formControlName","read_end_order","min","3","max","10",1,"w-4rem"],[1,"text-gray-600"],["pInputText","","type","time","formControlName","work_end_time",1,"w-full",3,"change"],["header","\u{1F680} T\u1ED1i \u01B0u Hi\u1EC7u n\u0103ng (Orange Pi)","styleClass","h-full shadow-md surface-50 border-blue-100 border-1"],[1,"font-bold","text-red-600"],["formControlName","perf_record_fps","optionLabel","label","optionValue","value","styleClass","w-full",3,"onChange","options"],[1,"font-bold","text-blue-600"],["formControlName","perf_view_fps","optionLabel","label","optionValue","value","styleClass","w-full",3,"onChange","options"],[1,"font-bold","text-purple-600"],[1,"font-bold"],["pInputText","","type","number","formControlName","perf_ai_interval","min","1","max","30",1,"w-5rem","text-center"],[1,"fixed","bottom-0","left-0","w-full","bg-white","border-t","border-gray-200","p-3","flex","justify-center","z-50","shadow-lg"],["label","L\u01B0u T\u1EA5t C\u1EA3 C\u1EA5u H\xECnh","icon","pi pi-save","styleClass","p-button-primary px-6 p-button-rounded font-bold",3,"onClick","loading"]],template:function(s,i){s&1&&(p(0,"p-toast"),e(1,"div",0)(2,"div",1)(3,"div",2)(4,"p-card",3)(5,"form",4)(6,"div",5)(7,"label",6),r(8,"\u0110\u1ED9 ph\xE2n gi\u1EA3i (Resolution)"),t(),e(9,"p-select",7),m("onChange",function(){return i.saveSettings()}),t(),e(10,"small",8),p(11,"i",9),r(12," 854x480 l\xE0 m\u1EE9c m\u01B0\u1EE3t nh\u1EA5t cho Orange Pi 3."),t()(),e(13,"div",5)(14,"label",6),r(15,"Th\u01B0 m\u1EE5c l\u01B0u tr\u1EEF"),t(),e(16,"input",10),m("blur",function(){return i.saveSettings()}),t(),e(17,"small",11),r(18,"N\u01A1i l\u01B0u Video/\u1EA2nh tr\xEAn th\u1EBB nh\u1EDB."),t()()()()(),e(19,"div",2)(20,"p-card",12)(21,"form",4)(22,"div",5)(23,"label",6),r(24,"Timeout (T\u1EF1 ng\u1EAFt)"),t(),e(25,"p-select",13),m("onChange",function(){return i.saveSettings()}),t(),e(26,"small",11),r(27,"T\u1EF1 \u0111\xF3ng \u0111\u01A1n n\u1EBFu Camera kh\xF4ng th\u1EA5y ng\u01B0\u1EDDi."),t()(),e(28,"div",5)(29,"label",6),r(30,"\u0110\u1ED9 nh\u1EA1y AI (Confidence)"),t(),e(31,"p-select",14),m("onChange",function(){return i.saveSettings()}),t()(),e(32,"div",5)(33,"label",6),r(34,"\u0110\u1ECDc s\u1ED1 cu\u1ED1i m\xE3 \u0111\u01A1n (TTS)"),t(),e(35,"div",15),p(36,"input",16),e(37,"span",17),r(38,"s\u1ED1 cu\u1ED1i"),t()(),e(39,"small",11),r(40,'V\xED d\u1EE5: M\xE3 ...8829 -> \u0110\u1ECDc "Hai ch\xEDn".'),t()(),e(41,"div",5)(42,"label",6),r(43,"Gi\u1EDD k\u1EBFt th\xFAc ca"),t(),e(44,"input",18),m("change",function(){return i.saveSettings()}),t()()()()(),e(45,"div",2)(46,"p-card",19)(47,"form",4)(48,"div",5)(49,"label",20),r(50,"FPS Ghi h\xECnh (Record)"),t(),e(51,"p-select",21),m("onChange",function(){return i.saveSettings()}),t(),e(52,"small",11),r(53,"Th\u1EA5p (10-12) gi\xFAp CPU kh\xF4ng b\u1ECB qu\xE1 t\u1EA3i khi n\xE9n video."),t()(),e(54,"div",5)(55,"label",22),r(56,"FPS Hi\u1EC3n th\u1ECB (View)"),t(),e(57,"p-select",23),m("onChange",function(){return i.saveSettings()}),t(),e(58,"small",11),r(59,"Gi\u1EDBi h\u1EA1n t\u1ED1c \u0111\u1ED9 x\u1EED l\xFD \u1EA3nh \u0111\u1EC3 m\xE1y m\xE1t h\u01A1n."),t()(),e(60,"div",5)(61,"label",24),r(62,"T\u1EA7n su\u1EA5t AI (Interval)"),t(),e(63,"div",15)(64,"span",25),r(65,"M\u1ED7i"),t(),p(66,"input",26),e(67,"span",25),r(68,"frame qu\xE9t 1 l\u1EA7n"),t()(),e(69,"small",11),r(70," T\u0103ng s\u1ED1 n\xE0y l\xEAn (vd: 12, 15) n\u1EBFu m\xE1y b\u1ECB lag. "),p(71,"br"),r(72,"12 = Qu\xE9t 2 l\u1EA7n/gi\xE2y. "),t()()()()()(),e(73,"div",27)(74,"p-button",28),m("onClick",function(){return i.saveSettings()}),t()()()),s&2&&(a(5),l("formGroup",i.settingForm),a(4),l("options",i.resolutions),a(12),l("formGroup",i.settingForm),a(4),l("options",i.timeoutOptions),a(6),l("options",i.aiOptions),a(16),l("formGroup",i.settingForm),a(4),l("options",i.fpsOptions),a(6),l("options",i.fpsViewOptions),a(17),l("loading",i.isLoading))},dependencies:[b,A,x,E,S,v,C,F,w,D,y,G,L,V,O,M,k,N,P,q,I],styles:['@charset "UTF-8";.surface-section[_ngcontent-%COMP%]{background-color:#f8fafc;min-height:100vh}  .p-card{border:none;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;border-radius:.75rem;background:#fff;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}  .p-card:hover{box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}  .p-card .p-card-header{padding:1.5rem 1.5rem .5rem;font-size:1.1rem;font-weight:600;color:#334155;border-bottom:1px solid #f1f5f9;margin-bottom:1rem}  .p-card .p-card-body{padding:1.5rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#475569;font-weight:500;font-size:.95rem}small[_ngcontent-%COMP%]{display:block;margin-top:.35rem;color:#94a3b8;font-size:.85rem}  .p-inputtext,   .p-inputnumber-input{width:100%;padding:.75rem 1rem;border-radius:.5rem;border:1px solid #cbd5e1;background-color:#f8fafc;transition:border-color .2s,background-color .2s}  .p-inputtext:hover,   .p-inputnumber-input:hover{border-color:#94a3b8}  .p-inputtext:focus,   .p-inputnumber-input:focus{border-color:#3b82f6;background-color:#fff;box-shadow:0 0 0 2px #3b82f633}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(1,minmax(0,1fr));gap:1.5rem}@media(min-width:768px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}.col-span-1[_ngcontent-%COMP%]{grid-column:span 1/span 1}.flex-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.gap-1[_ngcontent-%COMP%]{gap:.25rem}.gap-4[_ngcontent-%COMP%]{gap:1.5rem}.fixed-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background-color:#ffffffe6;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);padding:1rem 2rem;border-top:1px solid #e2e8f0;display:flex;justify-content:flex-end;z-index:100;box-shadow:0 -4px 6px -1px #0000000d}[_nghost-%COMP%]{display:block;padding-bottom:5rem}']})};export{H as SettingsComponent};
